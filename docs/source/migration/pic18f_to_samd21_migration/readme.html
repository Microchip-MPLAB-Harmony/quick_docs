<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <link rel="shortcut icon" href="../../../favicon.ico" type="image/x-icon"> <link rel="stylesheet" href="../../../assets/css/just-the-docs-default.css"> <script async src="https://www.googletagmanager.com/gtag/js?id=UA-2724382-16"></script> <script> window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'UA-2724382-16'); </script> <script type="text/javascript" src="../../../assets/js/vendor/lunr.min.js"></script> <script type="text/javascript" src="../../../assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.8.0 --> <title>Application migration from 8 bit PIC18F to 32 bit SAM D21 | Microchip MPLAB Harmony Quick Documentation help</title> <meta name="generator" content="Jekyll v3.9.3" /> <meta property="og:title" content="Application migration from 8 bit PIC18F to 32 bit SAM D21" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="Harmony 3 Quick Documentation package" /> <meta property="og:description" content="Harmony 3 Quick Documentation package" /> <link rel="canonical" href="../../../source/migration/pic18f_to_samd21_migration/readme.html" /> <meta property="og:url" content="../../../source/migration/pic18f_to_samd21_migration/readme.html" /> <meta property="og:site_name" content="Microchip MPLAB Harmony Quick Documentation help" /> <meta property="og:type" content="website" /> <meta name="twitter:card" content="summary" /> <meta property="twitter:title" content="Application migration from 8 bit PIC18F to 32 bit SAM D21" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"WebPage","description":"Harmony 3 Quick Documentation package","headline":"Application migration from 8 bit PIC18F to 32 bit SAM D21","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"../../assets/images/vendor/microchip_mplab_harmony_logo_150_transparent.png"}},"url":"../../../source/migration/pic18f_to_samd21_migration/readme.html"}</script> <!-- End Jekyll SEO tag --> </head> <body> <svg xmlns="http://www.w3.org/2000/svg" style="display: none;"> <symbol id="svg-link" viewBox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> </svg> <div class="side-bar"> <div class="site-header"> <a href="../../../index.html" class="site-title lh-tight"> <div class="site-logo"></div> </a> <a href="#" id="menu-button" class="site-button"> <svg viewBox="0 0 24 24" class="icon"><use xlink:href="#svg-menu"></use></svg> </a> </div> <nav role="navigation" aria-label="Main" id="site-nav" class="site-nav"> <ul class="nav-list"><li class="nav-list-item"><a href="../../../index.html" class="nav-list-link">Harmony 3 Quick Docs</a></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="../../../source/basic/readme.html" class="nav-list-link">Harmony Basics</a><ul class="nav-list "><li class="nav-list-item "><a href="../../../source/basic/mplab_harmony_3_code_configurator/readme.html" class="nav-list-link">MPLAB Code Configurator (MCC) for Harmony 3 Projects</a></li><li class="nav-list-item "><a href="../../../source/basic/mplab_harmony_3_configurator/readme.html" class="nav-list-link">MPLAB Harmony 3 Configurator (MHC)</a></li><li class="nav-list-item "><a href="../../../source/basic/mcc_overview_with_harmony_3/readme.html" class="nav-list-link">MPLAB Code Configurator Overview with MPLAB Harmony Content</a></li><li class="nav-list-item "><a href="../../../source/basic/mhc_project_graph/readme.html" class="nav-list-link">MHC Project Graph</a></li><li class="nav-list-item "><a href="../../../source/basic/mhc_clock_configuration/readme.html" class="nav-list-link">MHC Clock Configuration</a></li><li class="nav-list-item "><a href="../../../source/basic/mhc_pin_configuration/readme.html" class="nav-list-link">MHC Pin Configuration</a></li><li class="nav-list-item "><a href="../../../source/basic/mhc_nvic_configuration/readme.html" class="nav-list-link">MHC NVIC Configuration</a></li><li class="nav-list-item "><a href="../../../source/basic/mhc_dma_configuration/readme.html" class="nav-list-link">MHC DMA Configuration</a></li><li class="nav-list-item "><a href="../../../source/basic/mhc_memory_protection_unit_configuration/readme.html" class="nav-list-link">MHC Memory Protection Unit Configuration</a></li><li class="nav-list-item "><a href="../../../source/basic/mhc_code_generation/readme.html" class="nav-list-link">MHC Code Generation</a></li><li class="nav-list-item "><a href="../../../source/basic/mhc_window_manager_log_level/readme.html" class="nav-list-link">MHC Window manager and log level</a></li><li class="nav-list-item "><a href="../../../source/basic/create_first_harmony_3_project/readme.html" class="nav-list-link">Create First Harmony 3 Project</a></li><li class="nav-list-item "><a href="../../../source/basic/create_hello_world_sam_mcus/readme.html" class="nav-list-link">Create Hello World application on SAM MCUs</a></li><li class="nav-list-item "><a href="../../../source/basic/create_hello_world_pic_mcus/readme.html" class="nav-list-link">Create Hello World application on PIC MCUs</a></li><li class="nav-list-item "><a href="../../../source/basic/sam9x60_configure_second_stage_bootloader/readme.html" class="nav-list-link">Configure the second stage bootloader for SAM9X60 based MPUs</a></li><li class="nav-list-item "><a href="../../../source/basic/sama7g54_configure_second_stage_bootloader/readme.html" class="nav-list-link">Configure the second stage bootloader for SAMA7G54 based MPUs</a></li><li class="nav-list-item "><a href="../../../source/basic/configure_at91bootstrap_to_enable_qspi_xip_mpus/readme.html" class="nav-list-link">Configure at91bootstrap Second Stage Bootloader to enable QSPI XIP on MPUs</a></li><li class="nav-list-item "><a href="../../../source/basic/open_an_existing_harmony_3_project/readme.html" class="nav-list-link">Open an Existing Harmony 3 Project</a></li><li class="nav-list-item "><a href="../../../source/basic/sama7g54_samba_installation_setup/readme.html" class="nav-list-link">SAMBA installation and setup for SAMA7G54 EK</a></li><li class="nav-list-item "><a href="../../../source/basic/harmony_3_packages/readme.html" class="nav-list-link">Harmony 3 Packages</a></li><li class="nav-list-item "><a href="../../../source/basic/create_new_trust_zone_project/readme.html" class="nav-list-link">Create new TrustZone Project</a></li><li class="nav-list-item "><a href="../../../source/basic/create_iar_or_keil_project_using_mhc/readme.html" class="nav-list-link">Create IAR or Keil project using MHC</a></li><li class="nav-list-item "><a href="../../../source/basic/sam9x60_qspi_xip_application_using_mcc/readme.html" class="nav-list-link"></a></li><li class="nav-list-item "><a href="../../../source/basic/sama7g54_configure_first_stage_bootloader/readme.html" class="nav-list-link">SAMA7G54 Configure First Stage Bootloader</a></li><li class="nav-list-item "><a href="../../../source/basic/sam9x60_flash_boot_application_using_samba/readme.html" class="nav-list-link">SAM9X60 Flash boot and harmony application binaries using SAMBA</a></li><li class="nav-list-item "><a href="../../../source/basic/sam9x60_configure_first_stage_bootloader/readme.html" class="nav-list-link">SAM9X60 Configure First Stage Bootloader</a></li><li class="nav-list-item "><a href="../../../source/basic/sama7g54_flash_boot_application_using_samba/readme.html" class="nav-list-link">SAMA7G54 Flash boot and harmony application binaries using SAM BA</a></li><li class="nav-list-item "><a href="../../../source/basic/sam9x60_getting_started_application_using_mcc/readme.html" class="nav-list-link">Getting started with SAM9X60 Curiosity Development Board using MPLAB Harmony 3</a></li><li class="nav-list-item "><a href="../../../source/basic/harmony_sync_async_drivers/readme.html" class="nav-list-link">Differences Between Synchronous and Asynchronous Drivers</a></li><li class="nav-list-item "><a href="../../../source/basic/harmony_drivers_plibs/readme.html" class="nav-list-link">Difference Between MPLAB Harmony v3 PLIBs and Drivers</a></li><li class="nav-list-item "><a href="../../../source/basic/harmony_sync_drivers_freertos/readme.html" class="nav-list-link">Synchronous drivers and their usage in FreeRTOS based applications</a></li><li class="nav-list-item "><a href="../../../source/basic/create_new_harmony_3_project_using_mcc/readme.html" class="nav-list-link">Create a new MPLAB Harmony v3 project using MCC</a></li><li class="nav-list-item "><a href="../../../source/basic/add_new_configuration_to_harmony_3_project/readme.html" class="nav-list-link">Add a New Configuration to an Existing MPLAB Harmony v3 Project</a></li><li class="nav-list-item "><a href="../../../source/basic/update_mhc_harmony_3_project_to_mcc/readme.html" class="nav-list-link">Update and Configure an Existing MHC-based MPLAB Harmony v3 Project to MCC-based Project</a></li><li class="nav-list-item "><a href="../../../source/basic/harmony_3_project_manifest/readme.html" class="nav-list-link">MPLAB Harmony v3 Project Manifest Feature</a></li></ul></li><li class="nav-list-item active"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="../../../source/migration/readme.html" class="nav-list-link">Migration Guides</a><ul class="nav-list "><li class="nav-list-item "><a href="../../../source/migration/differences_harmony_2_to_harmony_3/readme.html" class="nav-list-link">Differences between Harmony 2 to Harmony 3</a></li><li class="nav-list-item "><a href="../../../source/migration/harmony_2_to_harmony_3/readme.html" class="nav-list-link">Harmony 2 to Harmony 3 Guide</a></li><li class="nav-list-item "><a href="../../../source/migration/aria_graphics_harmoy2_to_harmony_3/readme.html" class="nav-list-link">Aria Graphis Application Harmony2 to Harmony 3 Guide</a></li><li class="nav-list-item "><a href="../../../source/migration/tcpiip_harmoy2_to_harmony_3/readme.html" class="nav-list-link">TCP/IP Application Harmony2 to Harmony 3 Guide</a></li><li class="nav-list-item "><a href="../../../source/migration/sam9x60_ek_to_sam9x60_curiosity_harmony/readme.html" class="nav-list-link">Migrating a MPLAB Harmony 3 Application from the SAM9X60 EK to SAM9X60 Curiosity</a></li><li class="nav-list-item "><a href="../../../source/migration/usb_harmoy2_to_harmony_3/readme.html" class="nav-list-link">TCP/IP Application Harmony2 to Harmony 3 Guide</a></li><li class="nav-list-item "><a href="../../../source/migration/introduction_mplabx_harmony_3_to_studio_asf_users/readme.html" class="nav-list-link">Introduction to MPLABX and Harmony 3 to Atmel Studio and ASF Users</a></li><li class="nav-list-item "><a href="../../../source/migration/asf_to_harmony_3/readme.html" class="nav-list-link">Porting ASF to Harmony 3</a></li><li class="nav-list-item "><a href="../../../source/migration/atmel_start_to_harmony_3/readme.html" class="nav-list-link">Atmel START to MPLAB Harmony 3 Guide</a></li><li class="nav-list-item active"><a href="../../../source/migration/pic18f_to_samd21_migration/readme.html" class="nav-list-link active">Application migration from 8 bit PIC18F to 32 bit SAM D21</a></li><li class="nav-list-item "><a href="../../../source/migration/atmega4809_to_samd21_migration/readme.html" class="nav-list-link">Application migration from 8 bit AVR to 32 bit SAM D21</a></li><li class="nav-list-item "><a href="../../../source/migration/build_harmony_3_project_with_gcc/readme.html" class="nav-list-link">Build MPLAB Harmony v3 project with ARM GCC toolchain in MPLAB X IDE</a></li><li class="nav-list-item "><a href="../../../source/migration/code_generation_api_migration_from_mcc/readme.html" class="nav-list-link">Application migration from 8 bit AVR to 32 bit SAM D21</a></li><li class="nav-list-item "><a href="../../../source/migration/samc21_asf_to_pic32cmmc_harmony/readme.html" class="nav-list-link">Migrating ASF SAM C21 Application to MPLAB Harmony v3 PIC32CM MC</a></li><li class="nav-list-item "><a href="../../../source/migration/mplab_harmony_v3_project_migration/readme.html" class="nav-list-link">MPLAB Harmony v3 Project Migration</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="../../../source/peripheral/readme.html" class="nav-list-link">Peripheral Libraries</a><ul class="nav-list "><li class="nav-list-item "><a href="../../../source/peripheral/samc2x_getting_started/readme.html" class="nav-list-link">Getting Started with PLIBs on SAMC2x MCUs</a></li><li class="nav-list-item "><a href="../../../source/peripheral/samd5x_getting_started/readme.html" class="nav-list-link">Getting Started with PLIBs on SAM D5x/E5x MCUs</a></li><li class="nav-list-item "><a href="../../../source/peripheral/same70_getting_started/readme.html" class="nav-list-link">Getting Started with PLIBs on SAM E70/S70/V70/V71 MCUs</a></li><li class="nav-list-item "><a href="../../../source/peripheral/saml10_getting_started/readme.html" class="nav-list-link">Getting Started with PLIBs on SAM L10 MCUs</a></li><li class="nav-list-item "><a href="../../../source/peripheral/samd21_getting_started/readme.html" class="nav-list-link">Getting Started with PLIBs on SAM D21 MCUs</a></li><li class="nav-list-item "><a href="../../../source/peripheral/sam9x60_getting_started/readme.html" class="nav-list-link">Getting Started with PLIBs on SAM9X60 MPUs</a></li><li class="nav-list-item "><a href="../../../source/peripheral/pic32mz_getting_started/readme.html" class="nav-list-link">Getting Started with PLIBs on PIC32MZ EF MCUs</a></li><li class="nav-list-item "><a href="../../../source/peripheral/pic32mx_getting_started/readme.html" class="nav-list-link">Getting Started with PLIBs on PIC32MX 470 MCUs</a></li><li class="nav-list-item "><a href="../../../source/peripheral/pic32mk_getting_started/readme.html" class="nav-list-link">Getting Started with PLIBs on PIC32MK GP MCUs</a></li><li class="nav-list-item "><a href="../../../source/peripheral/samc2x_low_power/readme.html" class="nav-list-link">Low Power with PLIBs on SAMC2x MCUs</a></li><li class="nav-list-item "><a href="../../../source/peripheral/saml21_low_power/readme.html" class="nav-list-link">Low Power with PLIBs on SAM L21 MCUs</a></li><li class="nav-list-item "><a href="../../../source/peripheral/saml10_low_power/readme.html" class="nav-list-link">Low Power with PLIBs on SAM L10 MCUs</a></li><li class="nav-list-item "><a href="../../../source/peripheral/same54_low_power/readme.html" class="nav-list-link">Low Power with PLIBs on SAM E54 MCU</a></li><li class="nav-list-item "><a href="../../../source/peripheral/arm_trustzone_saml11_getting_started/readme.html" class="nav-list-link">Arm TrustZone Getting Started Application on SAM L11 MCUs</a></li><li class="nav-list-item "><a href="../../../source/peripheral/samd21_low_power/readme.html" class="nav-list-link">Low Power with PLIBs on SAMD21 MCUs</a></li><li class="nav-list-item "><a href="../../../source/peripheral/same70_getting_started_drivers/readme.html" class="nav-list-link">Getting Started with Drivers on SAM E70/S70/V70/V71 MCUs</a></li><li class="nav-list-item "><a href="../../../source/peripheral/same70_getting_started_drivers_freertos/readme.html" class="nav-list-link">Getting Started with Drivers on SAM E70/S70/V70/V71 MCUs using FreeRTOS</a></li><li class="nav-list-item "><a href="../../../source/peripheral/samd21_getting_started_drivers_freertos/readme.html" class="nav-list-link">Getting Started with Drivers on SAM D21 MCUs Using FreeRTOS</a></li><li class="nav-list-item "><a href="../../../source/peripheral/same5x_getting_started_drivers_freertos/readme.html" class="nav-list-link">Getting Started with Drivers on SAM E5x MCUs Using FreeRTOS</a></li><li class="nav-list-item "><a href="../../../source/peripheral/samc2x_getting_started_drivers_freertos/readme.html" class="nav-list-link">Getting Started with Drivers on SAM C2x MCUs Using FreeRTOS</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="../../../source/middleware/readme.html" class="nav-list-link">Middleware Examples</a><ul class="nav-list "><li class="nav-list-item "><a href="../../../source/middleware/pic32mz_getting_started_middleware/readme.html" class="nav-list-link">Getting Started with Middleware on PIC32MZ EF MCUs</a></li><li class="nav-list-item "><a href="../../../source/middleware/same70_getting_started_middleware/readme.html" class="nav-list-link">Getting Started with USB on SAM MCUs Using MPLAB Harmony v3</a></li><li class="nav-list-item "><a href="../../../source/middleware/rapid_prototyping/readme.html" class="nav-list-link">Rapid Prototyping with Curiosity Nano Using MPLAB Harmony v3</a></li><li class="nav-list-item "><a href="../../../source/middleware/harmony_3_audio_overview/readme.html" class="nav-list-link">MPLAB Harmony 3 Audio Overview</a></li><li class="nav-list-item "><a href="../../../source/middleware/digit_recognition_ai_ml/readme.html" class="nav-list-link">Digit Recognition AI/ML Application on SAM E51 IGAT CURIOSITY EVALUATION KIT Using MPLAB Harmony v3</a></li><li class="nav-list-item "><a href="../../../source/middleware/create_first_audio_application/readme.html" class="nav-list-link">Create first Audio Application</a></li><li class="nav-list-item "><a href="../../../source/middleware/web_photo_frame/readme.html" class="nav-list-link">Getting Started with MPLAB Harmony v3 to Create a Web-Enabled Digital Photo Frame</a></li><li class="nav-list-item "><a href="../../../source/middleware/pic32cmls60_secure_boot/readme.html" class="nav-list-link">Secure Boot on PIC32CM LS60 Curiosity Pro Evaluation Kit using MPLAB Harmony v3</a></li><li class="nav-list-item "><a href="../../../source/middleware/create_first_audio_decoder_application/readme.html" class="nav-list-link">Create first Audio Decoder Application</a></li><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="../../../source/middleware/sdcard_audio_player_reader_tutorial/readme.html" class="nav-list-link">SD Card Audio Player Reader Tutorial</a><ul class="nav-list"><li class="nav-list-item "> <a href="../../../source/middleware/sdcard_audio_player_reader_tutorial/audio_tone_using_a_lookup_table/readme.html" class="nav-list-link">Audio Tone using a lookup table</a> </li><li class="nav-list-item "> <a href="../../../source/middleware/sdcard_audio_player_reader_tutorial/audio_tone_using_text_file_in_sd_card/readme.html" class="nav-list-link">Audio Tone using text fil in SD card</a> </li><li class="nav-list-item "> <a href="../../../source/middleware/sdcard_audio_player_reader_tutorial/sd_card_reader_to_load_audio_files/readme.html" class="nav-list-link">SD card Reader to load Audio Files</a> </li><li class="nav-list-item "> <a href="../../../source/middleware/sdcard_audio_player_reader_tutorial/play_wav_audio_file_from_sd_card/readme.html" class="nav-list-link">Play WAV Audio File from SD Card</a> </li><li class="nav-list-item "> <a href="../../../source/middleware/sdcard_audio_player_reader_tutorial/display_graphics_to_select_and_play_audio_file/readme.html" class="nav-list-link">Display Graphics to Select and Play Audio File</a> </li></ul></li><li class="nav-list-item "><a href="../../../source/middleware/quickstart_prebuilt_graphics_applications/readme.html" class="nav-list-link">Quickstart Prebuilt Graphics Applications</a></li><li class="nav-list-item "><a href="../../../source/middleware/creating_a_new_graphics_application/readme.html" class="nav-list-link">Creating a new Graphics Application</a></li><li class="nav-list-item "><a href="../../../source/middleware/graphics_quick_start_application_guides/readme.html" class="nav-list-link">Graphics Quick Start Application Guides</a></li><li class="nav-list-item "><a href="../../../source/middleware/harmony_graphics_suite_user_guide/readme.html" class="nav-list-link">Harmony Graphics Suite User Guide</a></li><li class="nav-list-item "><a href="../../../source/middleware/harmony_qtouch_user_guide/readme.html" class="nav-list-link">Harmony QTouch User Guide</a></li><li class="nav-list-item "><a href="../../../source/middleware/ftp_harmony_tcpip/readme.html" class="nav-list-link">File Transfer Protocol Using MPLAB Harmony v3 TCP/IP Stack for SAM E54 MCU</a></li><li class="nav-list-item "><a href="../../../source/middleware/harmony_tcpip_user_guide/readme.html" class="nav-list-link">Harmony TCP/IP User Guide</a></li><li class="nav-list-item "><a href="../../../source/middleware/harmony_usb_stack_user_guide/readme.html" class="nav-list-link">Harmony USB Stack User Guide</a></li><li class="nav-list-item "><a href="../../../source/middleware/create_a_touch_project/readme.html" class="nav-list-link">Create a Touch Project</a></li><li class="nav-list-item "><a href="../../../source/middleware/create_touch_surface_gesture_project/readme.html" class="nav-list-link">Create Touch Surface and Gesture Project</a></li><li class="nav-list-item "><a href="../../../source/middleware/harmony_crypto_overview/readme.html" class="nav-list-link">Harmony Crypto Overview</a></li><li class="nav-list-item "><a href="../../../source/middleware/create_first_winc_bypass_mode_example/readme.html" class="nav-list-link">Create Your First WINC Bypass Mode Example</a></li><li class="nav-list-item "><a href="../../../source/middleware/harmony_winc_driver_architecture/readme.html" class="nav-list-link">Harmony WINC Driver Architecture</a></li><li class="nav-list-item "><a href="../../../source/middleware/create_first_bluetooth_application/readme.html" class="nav-list-link">Create first Bluetooth Application</a></li><li class="nav-list-item "><a href="../../../source/middleware/create_first_motor_control_application/readme.html" class="nav-list-link">Create first Motor Control Application</a></li><li class="nav-list-item "><a href="../../../source/middleware/create_first_tcpip_application/readme.html" class="nav-list-link">Create first TCPIP Application</a></li><li class="nav-list-item "><a href="../../../source/middleware/create_first_usb_device_application/readme.html" class="nav-list-link">Create first USB device application</a></li><li class="nav-list-item "><a href="../../../source/middleware/create_first_usb_host_application/readme.html" class="nav-list-link">Create first USB Host application</a></li></ul></li><li class="nav-list-item"><a href="../../../release_notes.html" class="nav-list-link">Release notes</a></li><li class="nav-list-item"><a href="../../../mplab_harmony_license.html" class="nav-list-link">License</a></li></ul> </nav> <footer class="site-footer"> This site uses <a href="https://github.com/pmarsceill/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll. </footer> </div> <div class="main" id="top"> <div id="main-header" class="main-header"> <div class="search"> <div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search Microchip MPLAB Harmony Quick Documentation help" aria-label="Search Microchip MPLAB Harmony Quick Documentation help" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label> </div> <div id="search-results" class="search-results"></div> </div> <nav aria-label="Auxiliary" class="aux-nav"> <ul class="aux-nav-list"> <li class="aux-nav-list-item"> <a href="https://support.microchip.com" class="site-button" > Obtain Support from Microchip </a> </li> </ul> </nav> </div> <div id="main-content-wrap" class="main-content-wrap"> <nav aria-label="Breadcrumb" class="breadcrumb-nav"> <ol class="breadcrumb-nav-list"> <li class="breadcrumb-nav-list-item"><a href="../../../source/migration/readme.html">Migration Guides</a></li> <li class="breadcrumb-nav-list-item"><span>Application migration from 8 bit PIC18F to 32 bit SAM D21</span></li> </ol> </nav> <div id="main-content" class="main-content" role="main"> <p>                                                                                                     <a href="../../../index.html"><img src="../../r_images/quick_home.png" title="Home" /></a> <a href="../readme.html"><img src="../../r_images/quick_back.png" title="Back" /></a></p> <h1 id="application-migration-from-8-bit-pic18f-to-32-bit-sam-d21-mcu"> <a href="#application-migration-from-8-bit-pic18f-to-32-bit-sam-d21-mcu" aria-labelledby="application-migration-from-8-bit-pic18f-to-32-bit-sam-d21-mcu" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Application migration from 8-bit PIC18F to 32-bit SAM D21 MCU </h1> <blockquote> <p>This page acts as a reference for migrating applications from 8-bit PIC Microcontroller (MCU) to 32-bit SAM MCU. This page shows how to migrate an application from <strong>PIC18F47Q10</strong> MCU to <strong>SAMD21G17D</strong> MCU with the help of an example.</p> </blockquote> <blockquote> <p>For the migration to a 32-bit MCU, the application uses <strong>SAM D21 Curiosity Nano Evaluation Kit</strong> and is developed on MPLAB® Harmony v3 software framework.</p> </blockquote> <blockquote> <p>The <a href="https://www.microchip.com/developmenttools/ProductDetails/DM320119">SAM D21 Curiosity Nano Evaluation Kit</a> is a hardware platform to evaluate the SAMD21G17D microcontroller (MCU). It is supported by the MPLAB® X Integrated Development Environment (IDE) and MPLAB Harmony v3 software development framework. The evaluation kit provides easy access to the features of the SAM D21 MCU to integrate the device into a custom design. Because the evaluation kit contains an On-Board Nano Debugger for programming and debugging, no external tools are necessary to program the SAMD21G17D device. The evaluation kit is compatible with Curiosity Nano Base board (Part Number - <a href="https://www.microchip.com/Developmenttools/ProductDetails/AC164162">AC164162</a>) which allows you to quickly scale and prototype your next innovative design using the SAMD21G17D MCU.</p> </blockquote> <blockquote> <p><a href="https://www.microchip.com/mplab/mplab-harmony">MPLAB® Harmony v3</a> is a flexible, fully integrated embedded software development framework for 32-bit microcontrollers (MCUs) and microprocessors (MPUs). MPLAB Harmony v3 includes the MPLAB Harmony Configurator (MHC) tool, a set of modular Peripheral Libraries (PLIBs), drivers, system services, middleware, and numerous example applications, all of which are designed to help quickly and easily develop powerful and efficient embedded software for Microchip’s 32-bit PIC® and SAM devices.</p> </blockquote> <blockquote> <p>This migration guide refers an existing application <a href="http://ww1.microchip.com/downloads/en/Appnotes/Getting-Started-with-UART-Using-EUSART-on-PIC18-90003282A.pdf">Getting Started with UART Using EUSART on PIC18</a> developed on <a href="https://www.microchip.com/Developmenttools/ProductDetails/DM182029">PIC18F47Q10 Curiosity Nano</a> evaluation kit using <a href="https://www.microchip.com/mplab/mplab-code-configurator">MPLAB® Code Configurator (MCC)</a> and discuss steps to migrate the existing application to SAM D21 Curiosity Nano Evaluation Kit using MPLAB® Harmony Configurator (MHC). The application is further extended by adding more peripheral specific functionality.</p> </blockquote> <blockquote> <p>The application developed on SAM D21 MCU will utilize:</p> <ul> <li>PORT PLIB to control the LED.</li> <li>External Interrupt Controller (EIC) PLIB and Systick PLIB to toggle the LED on SWITCH press event</li> <li>SERCOM (as Universal Synchronous Asynchronous Receiver Transmitter (USART)), STDIO Library and Direct Memory Access (DMA) PLIBs to print the Info messages on a COM (serial) port terminal application running on a PC and to receive command from serial terminal.</li> <li>SERCOM (as SPI) to run a self-loopback test.</li> </ul> </blockquote> <blockquote> <p>Two ways to use this guide:</p> <ol> <li>Create the project from scratch: <ul> <li>Follow step-by-step instructions below.</li> </ul> </li> <li>Use the solution project as an example: <ul> <li>Build the <a href="https://github.com/Microchip-MPLAB-Harmony/reference_apps/releases/latest/download/pic18f_to_samd21_migration.zip">solution project</a> and program it to the SAM D21 Curiosity Nano Evaluation Kit to observe the expected behavior.</li> </ul> </li> </ol> </blockquote> <blockquote> <p>This following bullet points provides links to the topics:</p> </blockquote> <ul> <li><a href="#hardware-used">Hardware Used</a></li> <li><a href="#software-tools-used">Software/Tools Used</a></li> <li><a href="#hardware-setup">Hardware Setup</a></li> <li><a href="#Description">Description</a> <ul> <li><a href="#Overview">Overview</a></li> <li><a href="#Install-MHC">Install MHC</a></li> <li><a href="#Create-MPLAB-Harmony-v3-Project">Create MPLAB Harmony v3 Project</a></li> <li><a href="#Configure-Clock">Configure Clock</a></li> <li><a href="#Add-SERCOM-(USART)-Peripheral">Add SERCOM (USART) Peripheral</a></li> <li><a href="#Generate-Code">Generate Code</a></li> <li><a href="#Add-Code">Add Code</a></li> <li><a href="#Build-and-Program">Build and Program</a></li> <li><a href="#Verify-Hello-World-output">Verify “Hello World” output</a></li> <li><a href="#Configure_Enable-Formatted-STDIO-USART-Receive-and-SWITCH_LED-functionality">Configure/Enable Formatted STDIO, USART Receive and SWITCH/LED functionality</a></li> <li><a href="#Verify-Formatted-STDIO,-USART-Receive-and-SWITCH/LED-functionality">Verify Formatted STDIO, USART Receive and SWITCH/LED functionality</a></li> <li><a href="#Extend-application-to-configure-SPI-loopback-using-DMA-based-Transfers">Extend application to configure SPI loopback using DMA based Transfers</a></li> <li><a href="#Verify-extended-functionality---SPI-loopback">Verify extended functionality - SPI loopback</a></li> </ul> </li> <li><a href="#results">Results</a></li> <li><a href="#analysis">Analysis</a></li> <li><a href="#conclusions">Conclusions</a></li> </ul> <h2 id="-"> <a href="#-" aria-labelledby="-" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <a id="hardware-used"> </a> </h2> <h2 id="hardware-used"> <a href="#hardware-used" aria-labelledby="hardware-used" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Hardware Used: </h2> <ul> <li><a href="https://www.microchip.com/Developmenttools/ProductDetails/DM320119">SAM D21 Curiosity Nano Evaluation Kit</a></li> <li>Connection wires</li> </ul> <h2 id="--1"> <a href="#--1" aria-labelledby="--1" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <a id="software-tools-used"> </a> </h2> <h2 id="softwaretools-used"> <a href="#softwaretools-used" aria-labelledby="softwaretools-used" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Software/Tools Used: </h2> <p><span style="color:blue"> <em>This project has been verified to work with the following versions of software tools:</em></span></p> <ul> <li><a href="https://github.com/Microchip-MPLAB-Harmony/csp/releases/tag/v3.12.0">MPLAB Harmony v3 “csp” repo v3.12.0</a></li> <li><a href="https://github.com/Microchip-MPLAB-Harmony/dev_packs/releases/tag/v3.12.0">MPLAB Harmony v3 “dev_packs” repo v3.12.0</a></li> <li><a href="https://github.com/Microchip-MPLAB-Harmony/mhc/releases/tag/v3.8.5">MPLAB Harmony v3 “mhc” repo v3.8.5</a></li> <li>MPLAB Harmony 3 Launcher Plugin v3.6.4</li> <li><a href="https://www.microchip.com/mplab/mplab-x-ide">MPLAB X IDE v6.00</a></li> <li><a href="https://www.microchip.com/mplab/compilers">MPLAB XC32 Compiler v4.00</a></li> <li>Any Serial Terminal application like Tera Term terminal application.</li> </ul> <p><span style="color:blue"> <em>Because Microchip regularly update tools, occasionally issue(s) could be discovered while using the newer versions of the tools. If the project doesn’t seem to work and version incompatibility is suspected, It is recommended to double-check and use the same versions that the project was tested with.</em> </span></p> <h2 id="--2"> <a href="#--2" aria-labelledby="--2" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <a id="hardware-setup"> </a> </h2> <h2 id="hardware-setup"> <a href="#hardware-setup" aria-labelledby="hardware-setup" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Hardware Setup </h2> <ul> <li>Connect the SAM D21 Curiosity Nano Development Board to the Host PC as a USB Device through a Type-A male to micro-B USB cable connected to Micro-B USB (Debug USB) port</li> <li> <p>Connect a wire from <strong>PA16 to PA19</strong> on SAM D21 Curiosity Nano Development Kit for SPI Self Loopback testing.</p> <p><img src="images/hardware.png" width="800" height="500" align="middle" /><br /> <img src="images/samd21_cnano_angle.png" width="800" height="500" align="middle" /></p> </li> </ul> <h2 id="--3"> <a href="#--3" aria-labelledby="--3" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <a id="Description"> </a> </h2> <h2 id="description"> <a href="#description" aria-labelledby="description" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Description </h2> <h2 id="--4"> <a href="#--4" aria-labelledby="--4" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <a id="Overview"> </a> </h2> <h3 id="overview"> <a href="#overview" aria-labelledby="overview" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Overview </h3> <p>This migration guide uses the PIC18 application which helps in “<strong>Getting Started with UART Using EUSART on PIC18</strong>”.</p> <ul> <li>Click <a href="https://github.com/microchip-pic-avr-examples/pic18f47q10-cnano-eusart-commands-fs">Here</a> to view/download the application.</li> <li>For details on the application, refer “Section 4” in the <a href="http://ww1.microchip.com/downloads/en/Appnotes/Getting-Started-with-UART-Using-EUSART-on-PIC18-90003282A.pdf">user guide</a>.</li> </ul> <p>The PIC18 application shows how to implement a command line interface. This way, the microcontroller can receive control commands via the EUSART. In this use case, an LED is controlled using commands sent from the MPLAB Data Visualizer.</p> <p>The application flow is as follows:</p> <ol> <li>Configures the system clock <br /> The clock is configured to 1 MHz using High Frequency Internal Oscillator (HFINTOSC).</li> <li>Configures USART3<br /> USART3 is configured for 9600 baud rate and the standard 8-N-1 (eight data bits, no parity bit and one Stop bit) frame format.</li> <li>Configures pins <br /> The USART TX, RX pins and LED pin are configured</li> <li>Implements STDIO receive and send functions <br /> STDIO library is implemented to receive and send commands from serial terminal</li> <li>Reads and execute valid commands<br /> Receives command from serial terminal and executes it</li> </ol> <p>Follow the below steps to get started migrating to SAMD21 and later extend the functionality by adding more peripherals.</p> <p><a id="Install-MHC"> </a></p> <h3 id="install-mhc"> <a href="#install-mhc" aria-labelledby="install-mhc" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Install MHC </h3> <ol> <li>Install the MPLAB® Harmony Configurator (MHC) Plug-in in the MPLAB X IDE if not installed.</li> <li>Verify the MPLAB® Harmony Configurator (MHC) Plug-in is installed. <ul> <li>Launch MPLAB X IDE from the Windows® Start Menu. Close all the projects and files that are currently open.</li> <li>Go to <strong>Tools &gt; Embedded</strong>.</li> <li>You will see <strong>MPLAB Harmony 3 Configurator</strong> in the menu <br /> <img src="images/mhc_lanuch.png" width="700" height="250" align="middle" /></li> </ul> </li> </ol> <p><a id="Create-MPLAB-Harmony-v3-Project"> </a></p> <h3 id="create-mplab-harmony-v3-project"> <a href="#create-mplab-harmony-v3-project" aria-labelledby="create-mplab-harmony-v3-project" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Create MPLAB Harmony v3 Project </h3> <ol> <li>Create MPLAB Harmony v3 Project Using MPLAB X IDE <ul> <li>Select <strong>File &gt; New Project</strong> from the main IDE menu <br /> <img src="images/new_project_selection.png" width="700" height="400" align="middle" /></li> <li>In the <strong>Categories pane</strong> of the <strong>New Project</strong> dialog window, select <strong>Microchip Embedded</strong>. In the <strong>Projects pane</strong>, select <strong>32-bit MPLAB Harmony 3 Project</strong>, then click <strong>Next</strong> <br /> <img src="images/choose_project.png" width="700" height="500" align="middle" /></li> <li>In the <strong>Framework Path</strong> edit box, browse to the folder you downloaded the framework to and select <strong>Next</strong> <br /> <img src="images/framework_path.png" width="700" height="500" align="middle" /></li> <li>In the <strong>Project Settings</strong> window, apply the following settings:</li> </ul> </li> <li><strong>Location</strong>: indicates the path to the root folder of the new project. All project files will be placed inside this folder. The project location can be any valid path, for example: <code class="language-plaintext highlighter-rouge">&lt;your project path&gt;</code>\pic18f_to_samd21</li> <li><strong>Folder</strong>: indicates the name of the MPLAB X .X folder. Enter “<em>pic18f_to_samd21_migration</em>” to create a pic18f_to_samd21_migration.X folder.</li> <li><strong>Name</strong>: enter the project’s logical name as “<em>pic18f_to_sam_d21_cnano</em>”. This is the name that will be shown from within the MPLAB X IDE. <ul> <li>Click Next to proceed to configuration settings <br /> <img src="images/project_settings.png" width="700" height="500" align="middle" /></li> <li>Follow the steps below to set the project’s configuration settings:</li> </ul> </li> <li><strong>Name</strong>: enter the configuration name as “sam_d21_cnano”.</li> <li><strong>Target Device</strong>: select <strong>ATSAMD21G17D</strong> as the target device.</li> <li>After selecting the target device, click <strong>Finish</strong> to launch MHC. <br /> <img src="images/config_settins.png" width="700" height="500" align="middle" /> <ul> <li>Device family pack path can be modified in below window. For now, use the default values <br /> <img src="images/config_database.png" width="700" height="200" align="middle" /></li> <li>The MHC plugin’s main window for the project will be displayed as shown in the following image <br /> <img src="images/mhc.png" align="middle" /></li> </ul> </li> </ol> <p><a id="Configure-Clock"> </a></p> <h3 id="configure-clock"> <a href="#configure-clock" aria-labelledby="configure-clock" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Configure Clock </h3> <ol> <li>Configuring Clock Settings<br /> The SAM D21 family of microcontrollers (MCUs) contains a sophisticated clock distribution system designed to give maximum flexibility to the user application. The clock system allows the tuning of the performance and power consumption of the device in a dynamic manner. The MHC provides an easy to use UI (User Interface) window, and a Clock Easy View window to configure the system and peripheral clocks. <ul> <li>Launch <strong>Clock Easy View</strong> by going to <strong>Tools</strong> menu of MHC window and then select <strong>Clock Configuration</strong> <br /> <img src="images/clock_launch.png" width="500" height="400" align="middle" /></li> <li>In the <strong>Clock Easy View</strong>, SAM D21 can operate at maximum 48 MHz, therefore <strong>Main Clock</strong> is set to 48 MHz.</li> <li>Change the <strong>Main Clock</strong> to 1MHz</li> <li>The Open loop Digital Frequency Locked Loop (DFLL 48 MHz) is configured and enabled to run the main clock. The configured DFLL is fed as input to the GCLK generator ‘0’ and a suitable clock divider (48) and masker must be selected to achieve a maximum frequency of 1 MHz. Refer to the following figure to configure the main clock to run at 1MHz</li> </ul> </li> </ol> <p><img src="images/samd21_clk.png" width="700" height="500" align="middle" /></p> <p>MHC clock easy view provides all the clock options available in the SAMD21 in a UI, which makes easier to configure the clock whenever necessary.</p> <p><a id="Add-SERCOM-(USART)-Peripheral"> </a></p> <h3 id="add-sercom-usart-peripheral"> <a href="#add-sercom-usart-peripheral" aria-labelledby="add-sercom-usart-peripheral" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Add SERCOM (USART) Peripheral </h3> <ol> <li>Adding SERCOM (USART) Peripheral<br /> MHC Graphical User Interface helps in selecting and configuring the peripherals needed by the project. It lists all the peripherals available in SAMD21 in an Active Component tab.</li> </ol> <ul> <li>Click on the <strong>Available Components</strong> tab in the left pane in the MPLAB® Harmony Configurator (MHC) window. Expand <strong>Peripherals &gt; SERCOM</strong></li> <li>Double click or drag and drop <strong>SERCOM5</strong> to add the USART Peripheral Library (PLIB) to the project graph.</li> </ul> <p><strong>Note:</strong> SAM D21 Curiosity Nano On-Board Nano Debugger also includes a Virtual Com port which is routed to SERCOM5, therefore in this application, SERCOM5 is chosen. <br /> <img src="images/selecting_sercom5.png" width="700" height="400" align="middle" /></p> <ul> <li>Select the <strong>SERCOM5 Peripheral Library</strong> in the project graph. Verify that the default “SERCOM Operation Mode” configuration is set as USART and configure 9600 baud rate and the standard 8-N-1 (eight data bits, no parity bit and one Stop bit) frame format.</li> </ul> <p><img src="images/sercom5_config.png" width="600" height="400" align="middle" /></p> <ol> <li>Configuring USART pins using MHC PIN Configurator<br /> The Pin Manager consists of Pin Settings, the Pin Diagram, and the Pin Table tabs, which enables users to configure (assign peripheral function, set pin direction, configure pull-up or pull-down and so on) and map the I/O pins.</li> </ol> <p>The following color combinations are associated with the pins in the graphical or table View:<br />  <strong>Gray</strong>: This pin is not usable in the selected configuration, and there is no enabled module which has any functionality on that pin. The grayed-out locks on a white background indicates the pins that are locked out by selected system functions.<br />  <strong>Blue</strong>: This pin is available and can be allocated to a module.<br />  <strong>Green</strong> (with a lock): This pin is allocated and selected for a module. The name displayed against the pin is either the name of the pin in the module’s context or a custom name entered.</p> <ul> <li>Open the <strong>Pin Configuration</strong> tabs by clicking on <strong>MHC &gt; Tools &gt; Pin Configuration</strong>. <br /> <img src="images/pin_conig_launch.png" width="600" height="300" align="middle" /></li> <li>Launching Pin configuration opens Pin Settings, the Pin Diagram, and the Pin Table tabs.</li> <li>select the MHC <strong>Pin Table</strong> tab and then scroll down to the <strong>SERCOM5</strong> module as shown below.<br />  Enable USART_TX on PA22 (Pin #31) <br />  Enable USART_TX on PB22 (Pin #37) <br /> <img src="images/sercom5_pin_config.png" width="600" height="200" align="middle" /></li> </ul> <p><a id="Generate-Code"> </a></p> <h3 id="generate-code"> <a href="#generate-code" aria-labelledby="generate-code" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Generate Code </h3> <ol> <li>Generate Code <ul> <li>When done, before generating code, click the <strong>Save</strong> icon in MPLAB® Harmony Configurator (MHC) as shown below. <br /> <img src="images/save_mhc_step1.png" width="200" height="50" align="middle" /></li> <li>Save the configuration in its default location when prompted. <br /> <img src="images/save_mhc_step2.png" width="700" height="500" align="middle" /></li> <li>Click on the <strong>Code Generate</strong> button as shown below to start generating code. <br /> <img src="images/generate_code_step1.png" width="250" height="50" align="middle" /></li> </ul> </li> </ol> <ul> <li>Click on the <strong>Generate</strong> button in the <strong>Generate Project</strong> window, keeping the default settings as shown below. If prompted for saving the configuration, click <strong>Save</strong>. <br /> <img src="images/save_mhc_confirmation.png" width="700" height="150" align="middle" /> <br /> <img src="images/generate_code_step2.png" width="700" height="600" align="middle" /></li> <li>As the code is generated, MHC displays the progress as shown below.<br /> <img src="images/generate_code_step3.png" width="900" height="600" align="middle" /></li> <li>Navigate to the <strong>Projects</strong> tab in MPLAB X IDE to view the project tree structure.</li> <li>Examine the generated code as shown below.<br /> <img src="images/project_tree.png" width="300" height="600" align="middle" /></li> </ul> <p>MHC will include all the MPLAB Harmony library files and generate the code based on the MHC selections. The generated code would add files and folders to your Harmony project as shown. Among the generated code, notice the Peripheral Library (PLIB) files generated for SERCOM 5 (as Universal Synchronous Asynchronous Receiver Transmitter (USART)), Clock and PORT peripherals.</p> <p><a id="Add-Code"> </a></p> <h3 id="add-code"> <a href="#add-code" aria-labelledby="add-code" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Add Code </h3> <ol> <li> <p>Navigate to the <strong>Projects</strong> tab in MPLAB X IDE and select main.c, add below code snippet in main function to print “Hello World” string on the serial terminal.<br /> uint8_t welcomeData[] = “Hello World\r\n”;</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> while ( true )
 {
   SERCOM5_USART_Write(&amp;welcomeData[0],sizeof(welcomeData));
 }    &lt;img src = "images/code_snippet1.png" width="400" height="300" align="middle"&gt;  
</code></pre></div> </div> </li> </ol> <p><a id="Build-and-Program"> </a></p> <h3 id="build-and-program"> <a href="#build-and-program" aria-labelledby="build-and-program" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Build and Program </h3> <ol> <li>Before proceeding to Build and program, set up the compiler toolchain. Click on the <strong>Projects</strong> tab on the top left pane in MPLAB X IDE. Right click on the project name <strong>pic18f_to_sam_d21_cnano</strong> and go to <strong>Properties</strong>.<br /> <img src="images/project_view.png" width="400" height="800" align="middle" /></li> <li>Make sure that XC32 (v2.41) is selected as the Compiler Toolchain for XC32. Click on <strong>Apply</strong> and then click on <strong>OK</strong>.<br /> <img src="images/project_properties.png" width="900" height="600" align="middle" /></li> <li>Clean and build your application by clicking on the <strong>Clean and Build</strong> button as shown below. <br /> <img src="images/clean_and_build_icon.png" width="300" height="50" align="middle" /></li> <li>Program your application to the device by clicking on the <strong>Make and Program</strong> button as shown below. <br /> <img src="images/make_and_program.png" width="300" height="50" align="middle" /> <br /> The lab should build and program successfully.</li> </ol> <p><a id="Verify-Hello-World-output"> </a></p> <h3 id="verify-hello-world-output"> <a href="#verify-hello-world-output" aria-labelledby="verify-hello-world-output" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Verify “Hello World” output </h3> <ol> <li>Now, open the <strong>Tera Term</strong> terminal application on your PC (from the Windows® Start menu by pressing the <strong>Start</strong> button). Select the <strong>Serial Port</strong> as shown below. <br /> <img src="images/tera_term_settings.png" width="600" height="400" align="middle" /></li> <li>Change the baud rate to 9600. <br /> <img src="images/tera_term_settings1.png" width="600" height="400" align="middle" /></li> <li>You should see the “Hello World” message displayed on the terminal as shown below. <br /> <img src="images/output1.png" width="600" height="400" align="middle" /></li> </ol> <p>You successfully completed printing the “Hello World” message on serial terminal. Let us continue and extend the functionality of the application as below.</p> <p><a id="Configure_Enable-Formatted-STDIO-USART-Receive-and-SWITCH_LED-functionality"> </a></p> <h3 id="configureenable-formatted-stdio-usart-receive-and-switchled-functionality"> <a href="#configureenable-formatted-stdio-usart-receive-and-switchled-functionality" aria-labelledby="configureenable-formatted-stdio-usart-receive-and-switchled-functionality" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Configure/Enable Formatted STDIO, USART Receive and SWITCH/LED functionality </h3> <ul> <li>Configure STDIO Library to use <strong>printf</strong> and <strong>scanf</strong> function to write and read data from the serial terminal respectively</li> <li>Receive the command from serial terminal and control the LED0 on the SAM D21 Curiosity evaluation kit</li> <li>Use Switch SW0 on the SAM D21 Curiosity Evaluation Kit to toggle the LED twice when it is pressed. External Interrupt controller (EIC) and Systick peripherals are used to achieve this <ol> <li>If you closed MHC accidently and would like to open it again, go to <strong>Tools &gt; Embedded &gt; MPLAB Harmony 3 Configurator</strong> in MPLAB X IDE.</li> <li>In the <strong>Project Graph</strong>, Select <strong>SERCOM5</strong>. Right click on yellow diamond and select consumer as <strong>STDIO</strong> as shown below<br /> <img src="images/sercom5_stdio.png" width="700" height="500" align="middle" /></li> <li>Select the MHC <strong>Pin Settings</strong> tab and then scroll down to the PORT pin <strong>PB10</strong> (Pin Number 19) in the <strong>Pin ID</strong> column and configure <strong>PB10</strong> as an output pin for LED functionality as shown below.<br /> <img src="images/led_pin_settings.png" width="1000" height="500" align="middle" /></li> <li>Select the <strong>Pin Settings</strong> tab and then scroll down to the PORT pin <strong>PB11</strong> (Pin Number 20) in the <strong>Pin ID</strong> column and configure <strong>PB11</strong> as an external interrupt pin for switch functionality as shown below. Internal pull-up is enabled to avoid false edge detection as there is no external pull-up on the SAM D21 Curiosity Nano Evaluation Kit.<br /> <img src="images/switch_pin_settings.png" width="1000" height="500" align="middle" /></li> <li>Select the Project Graph tab.</li> </ol> <ul> <li>Under the <strong>Available Components</strong> tab, expand <strong>Peripheral &gt; EIC</strong>. Select and double click on <strong>EIC</strong> to add the EIC module to the project.</li> </ul> <p><img src="images/eic_settings.png" width="700" height="400" align="middle" /></p> <ul> <li>Configure the EIC block to generate an interrupt every time the user presses the switch SW0 as shown below and enable filter functionality to avoid electrical noise on the switch pin. <br /> <img src="images/eic_settings1.png" width="500" height="500" align="middle" /> <br /> 21. Enable Systick to create a delay for toggling LED0, click on <strong>System</strong> in <strong>Project Graph</strong> and Configure as below.<br /> <img src="images/systick_settings.png" width="600" height="500" align="middle" /><br /> 22. When done, before generating code, click the <strong>Save</strong> icon in MPLAB® Harmony Configurator (MHC). Save the configuration in its default location when prompted. 23. Click on the <strong>Code Generate</strong> button to start generating code. 24. Click on the <strong>Generate</strong> button in the <strong>Generate Project</strong> window, keeping the default settings. If prompted for saving the configuration, click <strong>Save</strong>. 25. Navigate to the <strong>Projects</strong> tab in MPLAB X IDE and select main.c, add below code snippet to receive the command from serial terminal and a function to control the LED0 on the SAM D21 Curiosity Nano Evaluation Kit.</li> </ul> </li> <li> <p>In main.c, add the below function above “main” function #include <string.h></string.h></p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>                 void executeCommand(char *command)
                 {
                     if(strcmp(command, "ON") == 0)
                     {
                         LED_Clear();
                         printf("OK, LED ON.\r\n");
                     }
                     else if (strcmp(command, "OFF") == 0)
                     {
                         LED_Set();
                         printf("OK, LED OFF.\r\n");
                     }
                     else
                     {
                         printf("Incorrect command.\r\n");
                     }
                 }     &lt;img src = "images/code_snippet2.png" align="middle"&gt;                            
</code></pre></div> </div> </li> <li>Move “SERCOM5_USART_Write” function above while loop and add <strong>scanf</strong> inside the while loop as shown below. <br /> <img src="images/code_snippet3.png" align="middle" /> <ol> <li>Now, open the <strong>Tera Term</strong> terminal application on your PC. Enable <strong>Local echo</strong> in <strong>Setup &gt; Terminal</strong> as shown below.<br /> <img src="images/tera_term_settings2.png" width="600" height="300" align="middle" /></li> <li>Clean and build your application by clicking on the <strong>Clean and Build</strong> button.</li> </ol> </li> </ul> <p><a id="Verify-Formatted-STDIO,-USART-Receive-and-SWITCH/LED-functionality"> </a></p> <h3 id="verify-formatted-stdio-usart-receive-and-switchled-functionality"> <a href="#verify-formatted-stdio-usart-receive-and-switchled-functionality" aria-labelledby="verify-formatted-stdio-usart-receive-and-switchled-functionality" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Verify Formatted STDIO, USART Receive and SWITCH/LED functionality </h3> <ol> <li>Program your application to the device by clicking on the <strong>Make and Program</strong> button. The lab should build and program successfully.</li> <li>In Tera Term you should see “<strong>Hello World</strong>” message displayed.</li> <li>Type <strong>ON</strong> in serial terminal and press <strong>Enter</strong> to turn on LED0 on SAMD21 Curiosity Nano kit and Type <strong>OFF</strong> in serial terminal and press <strong>Enter</strong> to turn off LED0 on SAMD21 Curiosity Nano Evaluation Kit.<br /> <img src="images/output2.png" width="400" height="200" align="middle" /></li> <li>Switch SW0 is configured as interrupt using EIC peripheral, therefore register a call back in main function. Whenever user presses the switch, a callback will be notified and inside the call back, toggle the LED0 twice. <ul> <li>In main.c file, inside main function, add the below code. EIC_CallbackRegister(EIC_PIN_11,EIC_User_Handler, 0); SYSTICK_TimerStart();</li> <li> <p>In main.c, add the below code above main function static void EIC_User_Handler(uintptr_t context) { uint8_t i = 0;</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>          while(i&lt;4){
           LED_Toggle();
           SYSTICK_DelayMs(500);
           i++;
          }
       }    &lt;img src = "images/code_snippet4.png" align="middle"&gt;    
</code></pre></div> </div> </li> </ul> </li> <li>Clean and build your application by clicking on the <strong>Clean and Build</strong> button.</li> <li>Program your application to the device by clicking on the <strong>Make and Program</strong> button.</li> <li> <p>Press the Switch SW0 on SAM D21 Curiosity Nano Evaluation Kit and observe LED0 Toggling twice at 500ms rate.</p> <p>You successfully completed controlling the LED0 on the SAMD21 Curiosity Nano Evaluation Kit by receiving the commands from the serial terminal through USART and also toggled the LED0 on Switch SW0 press using EIC and Systick peripheral.</p> </li> </ol> <p><a id="Extend-application-to-configure-SPI-loopback-using-DMA-based-Transfers"> </a></p> <h3 id="extend-application-to-configure-spi-loopback-using-dma-based-transfers"> <a href="#extend-application-to-configure-spi-loopback-using-dma-based-transfers" aria-labelledby="extend-application-to-configure-spi-loopback-using-dma-based-transfers" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Extend application to configure SPI loopback using DMA based Transfers </h3> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Let us extend the functionality and add Serial Peripheral Interface (SPI) to perform a Self-Loopback test and add Direct memory address (DMA) to send the status of the SPI Transfer to the terminal without using CPU.
</code></pre></div></div> <ol> <li>Select the <strong>Project Graph</strong> tab. Under the <strong>Available Components</strong> tab, expand <strong>Peripheral &gt; SERCOM</strong>. Select and double click on <strong>SERCOM1</strong> to add the SPI module to the project. <br /> <img src="images/sercom1_config.png" width="700" height="450" align="middle" /></li> <li> <p>In <strong>Project Graph</strong> select <strong>SERCOM1</strong> and configure as below<br /> <img src="images/spi_config.png" width="600" height="450" align="middle" /></p> </li> <li> <p>Open <strong>Pin Table</strong>, Select <strong>SERCOM1</strong> and configure the pins as shown below<br /> <img src="images/spi_pin.png" width="800" height="200" align="middle" /></p> </li> <li>Launch <strong>DMA Configurator</strong> from <strong>MHC &gt; Tools &gt; DMA Configuration</strong><br /> <img src="images/dma_launch.png" width="600" height="400" align="middle" /></li> <li>Click on <strong>ADD Channel</strong> and Select <strong>SERCOM5_Transmit</strong> to configure the DMA<br /> <img src="images/dma_settings.png" align="middle" /></li> <li>When done, before generating code, click the <strong>*Save</strong> icon in MPLAB® Harmony Configurator (MHC). Save the configuration in its default location when prompted.</li> <li>Click on the <strong>Code Generate</strong> button to start generating code.</li> <li>Click on the <strong>Generate button</strong> in the <strong>Generate Project</strong> window, keeping the default settings.</li> <li>If prompted for saving the configuration, <strong>click Save</strong>.</li> <li> <p>In main.c, Add below code snippet SERCOM1_SPI_WriteRead(&amp;txData[0], sizeof(txData), &amp;rxData[0], sizeof(rxData));</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    /* Compare received data with the transmitted data */
    if ((memcmp(txData, rxData, sizeof(txData)) == 0))
    {
        /* Pass: Received data is same as transmitted data */
        DMAC_ChannelTransfer(DMAC_CHANNEL_0, "Received SPI Valid Data\r\n", \
        (const void *)&amp;(SERCOM5_REGS-&gt;USART_INT.SERCOM_DATA), \
        25);
    }
    else
    {       
        /* Fail: Received data is not same as transmitted data */
        DMAC_ChannelTransfer(DMAC_CHANNEL_0, "Received Invalid SPI Data\r\n", \
        (const void *)&amp;(SERCOM5_REGS-&gt;USART_INT.SERCOM_DATA), \
        27);
    }
     - Add below code snippet above main function
     uint8_t txData[]  = "SELF LOOPBACK DEMO FOR SPI!";
     uint8_t rxData[sizeof(txData)];   &lt;img src = "images/code_snippet5.png" align="middle"&gt;  
</code></pre></div> </div> </li> <li>Clean and build your application by clicking on the Clean and Build button.</li> <li>Program your application to the device by clicking on the Make and Program button.</li> </ol> <p><a id="Verify-extended-functionality---SPI-loopback"> </a></p> <h3 id="verify-extended-functionality---spi-loopback"> <a href="#verify-extended-functionality---spi-loopback" aria-labelledby="verify-extended-functionality---spi-loopback" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Verify extended functionality - SPI loopback </h3> <ol> <li>Connect PA16 and PA19 on SAM D21 Curiosity Nano Evaluation Kit using a connecting wire.</li> <li>Open Tera Term and observe the data as shown below. <br /> <img src="images/output3.png" align="middle" /></li> </ol> <p>You can still control the LED0 by sending the commands through serial terminal.</p> <h2 id="--5"> <a href="#--5" aria-labelledby="--5" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <a id="results"> </a> </h2> <h2 id="results"> <a href="#results" aria-labelledby="results" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Results </h2> <p>You observed the migration of application from PIC18F to SAMD21. You successfully used USART and STDIO to print the messages and receive the commands. Ports and EIC were used to control the LED and also configured SPI and DMA to perform self-loop back test.</p> <h2 id="--6"> <a href="#--6" aria-labelledby="--6" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <a id="analysis"> </a> </h2> <h2 id="analysis"> <a href="#analysis" aria-labelledby="analysis" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Analysis </h2> <p>You have successfully created your first application using MPLAB Harmony v3 on a SAM D21 microcontroller. Your application used all the fundamental elements that go into building a real-time application. Your successfully migrated application from PIC18F to SAMD21. In this application, you used MPLAB Harmony Configurator (MHC) to configure the SAM D21 and also used the MPLAB Harmony v3 Framework. You used the clock configurator to set up the CPU clock and also configured Systick. You configured SERCOM 5 (as Universal Synchronous Asynchronous Receiver Transmitter (USART)), SERCOM 1 (SPI), and External Interrupt Controller (EIC) Peripheral Libraries (PLIBs). You also configured the Direct Memory Access (DMA) using the DMA configurator. You used the pin configurator to set up the pins for LED and switch functions.</p> <h2 id="--7"> <a href="#--7" aria-labelledby="--7" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <a id="conclusions"> </a> </h2> <h2 id="conclusions"> <a href="#conclusions" aria-labelledby="conclusions" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Conclusions </h2> <p>This guide provided you overview of migrating an application from PIC18F to SAMD21. This guide also provided steps to configure and using all the fundamental components needed to build an application on a SAM D21 microcontroller with MPLAB Harmony v3 framework.</p> <h2 id="reference-links"> <a href="#reference-links" aria-labelledby="reference-links" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Reference Links </h2> <p><a href=""><a href="https://www.microchip.com/design-centers/32-bit" target="_blank"> <img src="../../r_images/32_bit_mcus.png" /> </a></a>       <a href=""><a href="https://www.microchip.com/design-centers/32-bit-mpus" target="_blank"> <img src="../../r_images/32_bit_mpus.png" /> </a></a>       <a href=""><a href="https://www.microchip.com/mplab/mplab-x-ide" target="_blank"> <img src="../../r_images/mplab_x_ide.png" /> </a></a>     <a href=""><a href="https://www.microchip.com/mplab/mplab-harmony" target="_blank"> <img src="../../r_images/mplab_harmony.png" /> </a></a> <a href=""><a href="https://www.microchip.com/mplab/compilers" target="_blank"> <img src="../../r_images/mplab_compiler.png" /> </a></a></p> <hr> <footer> <p class="text-small text-grey-dk-000 mb-0"><img src='https://raw.githubusercontent.com/wiki/Microchip-MPLAB-Harmony/Microchip-MPLAB-Harmony.github.io/images/microchip_logo.png' /><br />Copyright &copy; 2020 Microchip Technology.</p> <!-- <p class="text-small text-grey-dk-000 mb-0"><img src='../../../assets/images/vendor/microchip_logo.png' /><br /> Copyright &copy; 2023 Microchip Technology.</p> --> </footer> </div> </div> <div class="search-overlay"></div> </div> </body> </html>
